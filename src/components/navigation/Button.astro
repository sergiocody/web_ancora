---
import { Icon } from "astro-icon/components";
import { getIconName } from "@util/helpers";
const { href, label, icon, icon_only, color, className } = Astro.props;
const target = href.includes("http") ? "_blank" : "_self";
const isAnchor = href.startsWith("#");
---

<a
  href={href}
  class={`btn ${color || `surface-primary`} ${className || ""} ${!icon_only || "btn-icon"} ${isAnchor ? "smooth-scroll" : ""}`}
  target={target}
>
  {icon && <Icon name={getIconName(icon)} class="h-6 w-6" />}
  {!icon_only && <span>{label}</span>}
</a>

{isAnchor && (
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('a.smooth-scroll').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          const href = this.getAttribute('href');
          if (href && href.startsWith('#')) {
            e.preventDefault();
            const targetId = href.substring(1);
            const targetElement = document.getElementById(targetId);
            if (targetElement) {
              targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
          }
        });
      });
    });
  </script>
)}
